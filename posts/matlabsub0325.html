<!-- _layouts/default.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- _includes/head.html -->
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer-when-downgrade">
  <title>MATLAB Submission Scripts - yoonzh.com</title>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="ìœ¤å¿—" />
  <link rel="manifest" href="/site.webmanifest" />
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body);"></script>
  
</head>
</head>
<body class="">
  <!-- _includes/header.html -->
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-K2M9QVQ44D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-K2M9QVQ44D');
</script>

<header class="site-header">
  <div class="nav-container">
    <div class="logo-group">
      <a href="/" class="logo-image">
        <img src="/images/pepito-square.jpg" alt="Home">
      </a>
      <div class="logo-container">
        <a href="/" class="logo-link">
          <h1 class="logo">ìœ¤å¿—</h1>
        </a>
        <p class="logo-subtitle">[äº‘ ~ ì°Œ]</p>
      </div>
    </div>
    <nav class="nav-links">
      
        <a href="/projects/" class="hover-glow">Projects</a>
      
        <a href="/posts/" class="hover-glow">Posts</a>
      
        <a href="/about/" class="hover-glow">About</a>
      
    </nav>
  </div>
</header>
  
  <main class="page-content">
    <!-- _layouts/project.html -->
<article class="article-detail">
  <!-- _includes/article-content.html -->
<header class="article-header">
  <h1>
    MATLAB Submission Scripts
    
  </h1>
  
  <div class="article-meta">
    
      <time datetime="2025-04-02T00:00:00+00:00">
        ðŸ“… 2025/04/02
      </time>
    
  </div>
</header>

<div class="article-content">
  <p>Any inquiries or concerns, please contact me via email: <a href="mailto:yoon_zh@outlook.com">yoon_zh@outlook.com</a></p>

<p>To clarify, yes - this is my code.</p>

<p>Why copy from here instead of the PDF? The <code class="language-text highlighter-rouge">.tex</code> format messes up some of the code (for example, changing the <code class="language-text highlighter-rouge">''</code> into a different character) and copying the code is difficult. Here, you can simply click the <code class="language-text highlighter-rouge">Copy</code> button in the top left corner of the codeblock and paste in your MATLAB to run locally.</p>

<hr />

<h1 id="problem-1">Problem 1</h1>

<p>filename: problem1.m</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clc</span>
<span class="nb">clearvars</span>
<span class="nb">close</span> <span class="nb">all</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="o">-</span><span class="nb">pi</span><span class="p">,</span><span class="nb">pi</span><span class="p">,</span><span class="mi">50</span><span class="p">);</span>
<span class="n">y1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">y2</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
<span class="n">y3</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">range1_2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="n">range3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">];</span>

<span class="n">problem_1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">range1_2</span><span class="p">,</span> <span class="n">range3</span><span class="p">);</span>

<span class="k">function</span> <span class="n">problem_1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">range1_2</span><span class="p">,</span> <span class="n">range3</span><span class="p">)</span>
  <span class="c1">% Print plots in figure</span>
  <span class="nb">figure</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">,</span><span class="s1">'2470120'</span><span class="p">,</span><span class="s1">'NumberTitle'</span><span class="p">,</span><span class="s1">'off'</span><span class="p">)</span>
  <span class="nb">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
  <span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">'LineStyle'</span><span class="p">,</span><span class="s1">'-'</span><span class="p">,</span> <span class="s1">'Marker'</span><span class="p">,</span><span class="s1">'square'</span><span class="p">,</span><span class="s1">'Color'</span><span class="p">,</span><span class="s1">'r'</span><span class="p">)</span>
  <span class="nb">ylim</span><span class="p">(</span><span class="n">range1_2</span><span class="p">)</span>
  <span class="nb">title</span><span class="p">(</span><span class="s1">'y = 0.5*sin(x)'</span><span class="p">)</span>

  <span class="nb">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">'LineStyle'</span><span class="p">,</span><span class="s1">':'</span><span class="p">,</span> <span class="s1">'Marker'</span><span class="p">,</span><span class="s1">'*'</span><span class="p">,</span><span class="s1">'Color'</span><span class="p">,</span><span class="s1">'g'</span><span class="p">)</span>
  <span class="nb">ylim</span><span class="p">(</span><span class="n">range1_2</span><span class="p">)</span>
  <span class="nb">title</span><span class="p">(</span><span class="s1">'y = 3*cos(2*x)'</span><span class="p">)</span>

  <span class="nb">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
  <span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="s1">'LineStyle'</span><span class="p">,</span><span class="s1">'--'</span><span class="p">,</span><span class="s1">'Marker'</span><span class="p">,</span><span class="s1">'o'</span><span class="p">,</span><span class="s1">'Color'</span><span class="p">,</span><span class="s1">'b'</span><span class="p">)</span>
  <span class="nb">ylim</span><span class="p">(</span><span class="n">range3</span><span class="p">)</span>
  <span class="nb">title</span><span class="p">(</span><span class="s1">'y = exp(x)'</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<hr />

<h1 id="problem-2">Problem 2</h1>

<p>filename: problem2.m</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clc</span>
<span class="nb">clearvars</span>
<span class="nb">close</span> <span class="nb">all</span>

<span class="c1">%% Call functions below</span>
<span class="c1">% Problem 2-1</span>
<span class="n">ans2_1</span> <span class="o">=</span> <span class="n">problem_2_1</span><span class="p">();</span>
<span class="n">printans</span><span class="p">(</span><span class="n">ans2_1</span><span class="p">);</span>

<span class="c1">% Problem 2-2</span>
<span class="n">ans2_2</span> <span class="o">=</span> <span class="n">problem_2_2</span><span class="p">();</span>
<span class="n">printans</span><span class="p">(</span><span class="n">ans2_2</span><span class="p">);</span>

<span class="c1">% Problem 2-3</span>
<span class="n">ans2_3</span> <span class="o">=</span> <span class="n">simple_resistor_circuit</span><span class="p">();</span>
<span class="n">printans</span><span class="p">(</span><span class="n">ans2_3</span><span class="p">);</span>

<span class="c1">%% Initialize the matrix AA</span>
<span class="k">function</span> <span class="n">AA</span> <span class="o">=</span> <span class="n">initvar</span><span class="p">()</span>
  <span class="n">AA</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">8</span><span class="p">;</span>
       <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">8</span><span class="p">;</span>
        <span class="mi">6</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">5</span><span class="p">;</span>
        <span class="mi">7</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="k">end</span>

<span class="c1">%% Problem 2-1</span>
<span class="k">function</span> <span class="n">ans2_1</span> <span class="o">=</span> <span class="n">problem_2_1</span><span class="p">()</span>
  <span class="n">AA</span> <span class="o">=</span> <span class="n">initvar</span><span class="p">();</span>
  <span class="n">ans2_1</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">AA</span><span class="p">(</span><span class="mi">3</span><span class="p">,:)</span><span class="o">'</span><span class="p">;</span>
  <span class="n">ans2_1</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">AA</span><span class="p">(:,</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">ans2_1</span><span class="o">.</span><span class="n">BB</span> <span class="o">=</span> <span class="n">AA</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">);</span>
  <span class="n">ans2_1</span><span class="o">.</span><span class="n">CC</span> <span class="o">=</span> <span class="n">AA</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">ans2_1</span><span class="o">.</span><span class="n">DD</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">ans2_1</span><span class="o">.</span><span class="n">CC</span><span class="o">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[]);</span> <span class="c1">% transpose CC for column-wise op</span>
<span class="k">end</span>

<span class="c1">%% Problem 2-2</span>
<span class="k">function</span> <span class="n">ans2_2</span> <span class="o">=</span> <span class="n">problem_2_2</span><span class="p">()</span>
  <span class="n">ans2_2</span><span class="o">.</span><span class="n">array1</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">30</span><span class="p">;</span>
  <span class="n">ans2_2</span><span class="o">.</span><span class="n">rowvector</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
  <span class="n">ans2_2</span><span class="o">.</span><span class="n">array2</span> <span class="o">=</span> <span class="n">inneficient_for_loops</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="k">end</span>

<span class="c1">% Initialize a 4x4 array with 20 as all elements</span>
<span class="k">function</span> <span class="n">array2</span> <span class="o">=</span> <span class="n">inneficient_for_loops</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span>
  <span class="n">array2</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">);</span>
  <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">row</span>
    <span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">col</span>
      <span class="n">array2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1">%% Problem 2-3</span>
<span class="k">function</span> <span class="n">ans2_3</span> <span class="o">=</span> <span class="n">simple_resistor_circuit</span><span class="p">()</span>
  <span class="c1">% % The lazy way (if the equation is really difficult)</span>
  <span class="c1">% % Uncomment to try</span>
  <span class="c1">% syms i1 i2 i3</span>
  <span class="c1">% eqns = [12 + 10*i1 + 2*(i1-i2) + 5*(i1 - i3) + 7*i1 == 0;...</span>
  <span class="c1">%              5*i2 + 3*(i2-i3) + 2*(i2-i1) == 0;...</span>
  <span class="c1">%              3*(i3-i2) - 10 + 6*i3 + 5*(i3-i1) == 0];</span>
  <span class="c1">% vars = [i1 i2 i3];</span>
  <span class="c1">% [ans2_3.i1, ans2_3.i2, ans2_3.i3] = solve(eqns, vars);</span>

  <span class="c1">% The cleaner, resource-wise way (if all eqns are of first order)</span>
  <span class="c1">% == i1  i2  i3 ==</span>
  <span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">;</span>
       <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">;</span>
       <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">];</span>
  <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span><span class="o">'</span><span class="p">;</span>
  <span class="n">sol</span> <span class="o">=</span> <span class="n">A</span><span class="p">\</span><span class="n">b</span><span class="p">;</span>
  <span class="c1">% Turn to struct for easy printing with printans() function</span>
  <span class="n">ans2_3</span> <span class="o">=</span> <span class="nb">cell2struct</span><span class="p">(</span><span class="nb">num2cell</span><span class="p">(</span><span class="n">sol</span><span class="p">),</span> <span class="p">{</span><span class="s1">'i1'</span><span class="p">,</span> <span class="s1">'i2'</span><span class="p">,</span> <span class="s1">'i3'</span><span class="p">},</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">end</span>

<span class="c1">%% Print values in struct</span>
<span class="c1">% All functions return structs, this prints the answers</span>
<span class="k">function</span> <span class="n">printans</span><span class="p">(</span><span class="n">ans_struct</span><span class="p">)</span>
  <span class="n">fn</span> <span class="o">=</span> <span class="nb">fieldnames</span><span class="p">(</span><span class="n">ans_struct</span><span class="p">);</span>
  <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="nb">disp</span><span class="p">(</span><span class="n">fn</span><span class="p">{</span><span class="n">i</span><span class="p">})</span>
    <span class="nb">disp</span><span class="p">(</span><span class="n">ans_struct</span><span class="o">.</span><span class="p">(</span><span class="n">fn</span><span class="p">{</span><span class="n">i</span><span class="p">}))</span>
    <span class="nb">disp</span><span class="p">(</span><span class="s1">'Size: '</span><span class="p">)</span>
    <span class="nb">disp</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">ans_struct</span><span class="o">.</span><span class="p">(</span><span class="n">fn</span><span class="p">{</span><span class="n">i</span><span class="p">})))</span>
    <span class="nb">disp</span><span class="p">(</span><span class="s1">'================================'</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<hr />

<h1 id="problem-3">Problem 3</h1>

<p>filename: problem3.m</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clc</span>
<span class="nb">clearvars</span>
<span class="nb">close</span> <span class="nb">all</span>

<span class="c1">%% Initialize values</span>

<span class="c1">% Initial values of a</span>
<span class="n">init_a</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">@</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">t</span><span class="p">};</span>

<span class="c1">% Initial values Î¸(0), Î¸'(0)</span>
<span class="n">init_conds</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="mf">0.5</span><span class="p">;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">;</span>   <span class="mi">0</span><span class="p">]</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">;</span>   <span class="mi">0</span><span class="p">]</span>
<span class="p">};</span> <span class="c1">% Î¸(0) Î¸'(0)</span>

<span class="c1">% Range of t</span>
<span class="n">trange</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">10</span><span class="p">];</span>

<span class="c1">%% Solve ODE, print figure</span>
<span class="nb">figure</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">,</span><span class="s1">'Pendulum'</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">init_a</span><span class="p">{</span><span class="n">i</span><span class="p">};</span>
  <span class="n">conds</span> <span class="o">=</span> <span class="n">init_conds</span><span class="p">{</span><span class="n">i</span><span class="p">};</span>

  <span class="c1">% Consider a as dependant of t</span>
  <span class="n">ode_fun</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="n">ode_pendulum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">a</span><span class="p">);</span>
  <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ode45</span><span class="p">(</span><span class="n">ode_fun</span><span class="p">,</span> <span class="n">trange</span><span class="p">,</span> <span class="n">conds</span><span class="p">);</span>
  <span class="nb">disp</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
  <span class="n">print_subplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">conds</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="k">end</span>


<span class="c1">%% Define ODE</span>
<span class="k">function</span> <span class="n">dydt</span> <span class="o">=</span> <span class="n">ode_pendulum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a_val</span><span class="p">)</span>
  <span class="c1">% Define constants</span>
  <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span><span class="p">;</span>
  <span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="c1">% Parse a</span>
  <span class="k">if</span> <span class="nb">isa</span><span class="p">(</span><span class="n">a_val</span><span class="p">,</span> <span class="s1">'function_handle'</span><span class="p">)</span> <span class="c1">% If a is a function of t</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a_val</span><span class="p">(</span><span class="n">t</span><span class="p">);</span> <span class="c1">% Evaluate a at "t"</span>
  <span class="k">else</span> <span class="c1">% If a is constant, just copy the number</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a_val</span><span class="p">;</span>
  <span class="k">end</span>

  <span class="c1">% Let y(1) = Î¸(t),  y(2) = Î¸'(t)</span>
  <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">((</span><span class="n">a</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="p">/</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
  <span class="p">];</span>
<span class="k">end</span>

<span class="c1">%% Print graphs</span>
<span class="k">function</span> <span class="n">print_subplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">theta_0</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">isa</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">'function_handle'</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">func2str</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
  <span class="k">end</span>
  <span class="nb">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
  <span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">'-'</span><span class="p">)</span>
  <span class="nb">title</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">'a = %s, \\theta(0) = %g'</span><span class="p">,</span> <span class="nb">string</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">theta_0</span><span class="p">))</span>
  <span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time (s)'</span><span class="p">)</span>
  <span class="nb">ylabel</span><span class="p">(</span><span class="s1">'\theta(t), rad'</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<hr />

<h1 id="problem-4">Problem 4</h1>

<p>filename: problem4.m</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clc</span>
<span class="nb">clearvars</span>
<span class="nb">close</span> <span class="nb">all</span>

<span class="c1">% Define time vectors for t &lt; 0 and t &gt;= 0</span>
<span class="n">t_neg</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>          <span class="c1">% From -20 to 0 Î¼s</span>
<span class="n">t_pos</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span> <span class="c1">% From 0 to 100 Î¼s</span>

<span class="c1">% Convert time to microseconds (for printing plots)</span>
<span class="n">t_neg_micro</span> <span class="o">=</span> <span class="n">t_neg</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">;</span>
<span class="n">t_pos_micro</span> <span class="o">=</span> <span class="n">t_pos</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">;</span>

<span class="c1">% Compute i_L</span>
<span class="n">i_L_neg</span> <span class="o">=</span> <span class="mf">0.36</span> <span class="o">*</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">t_neg</span><span class="p">));</span>
<span class="n">i_L_pos</span> <span class="o">=</span> <span class="mf">0.36</span> <span class="o">*</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">50000</span> <span class="o">*</span> <span class="n">t_pos</span><span class="p">);</span>

<span class="c1">% Compute i_1</span>
<span class="n">i_1_neg</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">t_neg</span><span class="p">));</span>
<span class="n">i_1_pos</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.24</span> <span class="o">*</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">50000</span> <span class="o">*</span> <span class="n">t_pos</span><span class="p">);</span>

<span class="c1">%% Plot i_L and i_1 in subplots</span>
<span class="nb">figure</span><span class="p">;</span>

<span class="c1">% Subplot for i_L</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t_neg_micro</span><span class="p">,</span> <span class="n">i_L_neg</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'LineWidth'</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t_pos_micro</span><span class="p">,</span> <span class="n">i_L_pos</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'LineWidth'</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">off</span><span class="p">;</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Inductor Current i_L(t)'</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time (Î¼s)'</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Current (A)'</span><span class="p">);</span>
<span class="nb">grid</span> <span class="n">on</span><span class="p">;</span>

<span class="c1">% Subplot for i_1</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t_neg_micro</span><span class="p">,</span> <span class="n">i_1_neg</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="s1">'LineWidth'</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t_neg_micro</span><span class="p">(</span><span class="k">end</span><span class="p">),</span> <span class="n">i_1_neg</span><span class="p">(</span><span class="k">end</span><span class="p">),</span> <span class="s1">'ro'</span><span class="p">,</span> <span class="s1">'LineWidth'</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span> <span class="c1">% The current jumps</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t_pos_micro</span><span class="p">,</span> <span class="n">i_1_pos</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="s1">'LineWidth'</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">);</span>
<span class="nb">hold</span> <span class="n">off</span><span class="p">;</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Current i_1(t)'</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time (Î¼s)'</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Current (A)'</span><span class="p">);</span>
<span class="nb">grid</span> <span class="n">on</span><span class="p">;</span>
</code></pre></div></div>

<hr />

<h1 id="problem-5">Problem 5</h1>

<p>filename: problem5.m</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

</div>
</article>
  </main>

  <!-- _includes/footer.html -->
<footer class="site-footer">
  <div class="footer-content">
    <div class="social-links">
      <a href="https://github.com/yoon-zh" class="hover-glow" aria-label="GitHub">
        <i class="fab fa-github"></i>
      </a>
      <a href="mailto:yoon_zh@outlook.com" class="hover-glow" aria-label="Email">
        <i class="fas fa-envelope"></i>
      </a>
      <a href="https://www.linkedin.com/in/jorge-porras-1a7393282/" class="hover-glow" aria-label="LinkedIn">
        <i class="fab fa-linkedin"></i>
      </a>
      <a href="https://t.me/yo_o_n" class="hover-glow" aria-label="Telegram">
        <i class="fab fa-telegram-plane"></i>
      </a>
    </div>
    <div class="footer-bottom">
      <p>Â© 2025 ìœ¤å¿—. All rights reserved.</p>
    </div>
  </div>
</footer>
<script src="/scripts/main.js"></script>
<script src="/scripts/codeblocks.js"></script>
<script src="/scripts/axeptio.js"></script>
</body>
</html>